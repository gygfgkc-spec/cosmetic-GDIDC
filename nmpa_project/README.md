# 使用说明书

## 1. 简介
这是一个专门用于抓取 **广东省特殊化妆品备案信息** 的自动化工具。它会自动打开浏览器，筛选“广东省”，并把所有状态为“当前批件”的产品信息（包括配方和使用目的）保存到 Excel 表格中。

## 2. 安装准备
在运行之前，请确保你的电脑上已经安装了 **Python**。
如果你还没有安装 Python，请去官网下载并安装（记得勾选 "Add Python to PATH"）。

## 3. 如何使用
### Windows 用户（推荐）
1. 双击文件夹里的 **`一键运行.bat`** 文件。
2. 黑底白字的窗口会出现，它会自动安装需要的东西，然后启动浏览器。
3. **不要关闭** 那个黑底白字的窗口，也不要关闭自动打开的浏览器。

### Mac / Linux 用户
打开终端，进入本文件夹，运行：
```bash
pip install -r requirements.txt
playwright install
python nmpa_spider.py
```

## 4. 运行过程中的注意事项
1. **浏览器会自动打开**：你会看到一个浏览器窗口自动打开并跳转到 NMPA 网站。
2. **自动筛选**：程序会自动点击“广东省”。
   - **重要**：如果程序在“正在选择广东省”这一步卡住超过15秒，请你**手动在那个浏览器里点击一下“广东省”**，程序检测到后会继续运行。
3. **抓取数据**：
   - 程序会自动一页页翻页。
   - 它会把数据实时保存在当前文件夹下的 `guangdong_cosmetics.csv` 文件中。
   - 你可以用 Excel 直接打开这个文件查看。
4. **如何停止**：
   - 如果你想结束抓取，直接关闭黑色的命令行窗口即可。

## 5. 常见问题
- **Q: 浏览器闪退怎么办？**
  - A: 可能是网络问题，请检查网络后重新运行。
- **Q: 抓下来的数据是乱码？**
  - A: 请用 Excel 的“数据”->“从文本/CSV”导入功能打开，或者用记事本打开查看。
- **Q: 为什么有些数据没有配方？**
  - A: 并不是所有产品都有公开的配方信息，或者该产品的弹窗加载失败。程序会尽力抓取。

祝使用愉快！
