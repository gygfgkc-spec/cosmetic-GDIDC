# 使用说明书

## 1. 简介
这是一个专门用于抓取 **广东省特殊化妆品备案信息** 的自动化工具。它会自动打开浏览器，筛选“广东省”，并把所有状态为“当前批件”的产品信息（包括配方和使用目的）保存到 Excel 表格中。

## 2. 关键：安装 Python 的注意事项
**如果你运行报错说找不到命令，请务必看这里！**

安装 Python 时，安装界面的**底部**有一个选项叫 **"Add Python to PATH"** (或者 "Add Python 3.x to PATH")。
**一定要勾选它！一定要勾选它！一定要勾选它！**

如果你已经安装了但没勾选，建议卸载重装，或者手动添加环境变量（重装最快）。

## 3. 如何使用 (三种模式)

### 模式 A：普通模式（推荐先试这个）
双击 **`一键运行.bat`**。它会自动尝试使用国内镜像加速下载。

### 模式 B：VPN 模式（如果你有梯子/VPN）
**强烈推荐！** 如果你有 VPN，请双击 **`一键运行(VPN模式).bat`**。
注意：该脚本默认使用端口 `33210`。如果你的 VPN 端口不一样，请右键编辑该文件修改端口号。

### 模式 C：环境诊断
如果上面都打不开，请双击 **`环境诊断.bat`**，它会告诉你电脑缺什么。

## 4. 运行过程中的注意事项
1. **浏览器会自动打开**：你会看到一个浏览器窗口自动打开并跳转到 NMPA 网站。
2. **自动筛选**：程序会自动点击“广东省”。
   - **重要**：如果程序在“正在选择广东省”这一步卡住超过15秒，请你**手动在那个浏览器里点击一下“广东省”**，程序检测到后会继续运行。
3. **抓取数据**：
   - 程序会自动一页页翻页。
   - 它会把数据实时保存在当前文件夹下的 `guangdong_cosmetics.csv` 文件中。
   - 你可以用 Excel 直接打开这个文件查看。
4. **如何停止**：
   - 如果你想结束抓取，直接关闭黑色的命令行窗口即可。

## 5. 常见问题
- **Q: 提示 "电脑上找不到 Python"？**
  - A: 请参考第 2 节，重新安装 Python 并勾选 "Add Python to PATH"。
- **Q: 浏览器闪退或者报错？**
  - A: 可能是网络问题，请检查网络后重新运行。
- **Q: 抓下来的数据是乱码？**
  - A: CSV 文件默认是 UTF-8 编码。请用 Excel 的“数据”->“从文本/CSV”导入功能打开，或者用记事本打开查看。
- **Q: 为什么有些数据没有配方？**
  - A: 并不是所有产品都有公开的配方信息，或者该产品的弹窗加载失败。程序会尽力抓取。

祝使用愉快！
